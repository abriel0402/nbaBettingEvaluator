<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
    <title>Document</title>
</head>
<body>

    <div>
        <nav class="navbar navbar-expand-lg navbar-light bg-white row">
        <a href="{% url 'points' %}"class="navbar-brand text-black col-sm text-center">Points</a>    
        <a href="{% url 'assists'%}"class="navbar-brand text-black col-sm text-center">Assists</a>  
        <a href="{% url 'rebounds' %}"class="navbar-brand text-black col-sm text-center">Rebounds</a>  
        <a href="{% url 'pa' %}"class="navbar-brand text-black col-sm text-center">Points+Assists</a>  
        <a href="{% url 'pr' %}"class="navbar-brand text-black col-sm text-center">Points+Rebounds</a>  
        <a href="{% url 'ra' %}"class="navbar-brand text-black col-sm text-center">Rebounds+Assists</a>  
        <a href="{% url 'pra' %}" class="navbar-brand text-black col-sm text-center">Points+Rebounds+Assists</a>  
        <a class="navbar-brand text-black col-sm text-center">Steals</a>  
        <a class="navbar-brand text-black col-sm text-center">Blocks</a>  
        <a class="navbar-brand text-black col-sm text-center">Steals+Blocks</a>  
        <a class="navbar-brand text-black col-sm text-center">Turnovers</a>
        
    </nav>
</div>



<div class="text-center p-2">
    <h1 class="p-2 pt-3">{{ leg.player }}</h1>
    <h2 class="p-2">Line: {{ leg.line }} {{ stat }}</h2>
    
<div class="text-center p-1">
    <h3>Projection</h3>
    <button class="{{color}}">{{decision}}</button>
    </div>
    
    <h4 class="pt-2">Last 5 Hit Rate: {{ hitRate5 }} ({{ average5 }} {{statPerGame}})</h4>
    <h4 class="p-1">Last 10 Hit Rate: {{ hitRate10 }} ({{ average10 }} {{statPerGame}})</h4>
    <h4 class="p-1">Last 20 Hit Rate: {{ hitRate20 }} ({{ average20 }} {{statPerGame}})</h4>
    <h4 class="p-1">Season Hit Rate: {{ hitRateSzn }} ({{ averageSeason }} {{statPerGame}})</h4>

        
</div>
<div class="text-center p-3">
    <h4>Last 5 Games</h4>
    <h5>
    {% for stat in leg.last5 %}
    
    {{ stat }} &nbsp;&nbsp;&nbsp;

    {% endfor %}
    </h5>

    
      
    <div style="width: 600px; height: 400px;" class="mx-auto">
        <div class="btn-group mb-3" role="group" aria-label="Game chart period">
            <button type="button" class="btn btn-primary" onclick="updateChart(5)" id="defaultOpen">Last 5</button>
            <button type="button" class="btn btn-primary" onclick="updateChart(10)">Last 10</button>
            <button type="button" class="btn btn-primary" onclick="updateChart(20)">Last 20</button>
          </div>
        <canvas id="myChart"></canvas>
      </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.min.js"></script>

    <script>
        var ctx = document.getElementById('myChart').getContext('2d');
        var myChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['Game 1', 'Game 2', 'Game 3', 'Game 4', 'Game 5'],
                datasets: [{
                    label: 'Bar',
                    data: {{leg.last5}},
                    backgroundColor: function(context) {
                      var value = context.dataset.data[context.dataIndex];
                      var color = value >= {{leg.line}} ? '#006847' : '#CE1126';
                      return color;
                    },
                    borderColor: 'rgba(0, 0, 0, 1)',
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    xAxes: [{
                        display: false,
                        ticks: {
                            beginAtZero: true
                        },
                        gridLines: {
                            display: false,
                        }
                    }],
                    yAxes: [{
                        display: false,
                        ticks: {
                            beginAtZero: true
                        },
                        gridLines: {
                            display: false,
                        }
                    }]
                },
                legend: {
                    display: false
                }
            }
        });
        
        // Set the "Last 5" button to active by default
        document.getElementById("defaultOpen").classList.add("active");

        function updateChart(period) {
            if (period === 5) {
                myChart.data.datasets[0].data = {{leg.last5}};
                myChart.data.labels = ['Game 1', 'Game 2', 'Game 3', 'Game 4', 'Game 5'];
            } else if (period === 10) {
                myChart.data.datasets[0].data = {{leg.last10}};
                myChart.data.labels = ['Game 1', 'Game 2', 'Game 3', 'Game 4', 'Game 5', 'Game 6', 'Game 7', 'Game 8', 'Game 9', 'Game 10'];
            } else if (period === 20) {
                myChart.data.datasets[0].data = {{leg.last20}};
                myChart.data.labels = ['Game 1', 'Game 2', 'Game 3', 'Game 4', 'Game 5', 'Game 6', 'Game 7', 'Game 8', 'Game 9', 'Game 10', 'Game 11', 'Game 12', 'Game 13', 'Game 14', 'Game 15', 'Game 16', 'Game 17', 'Game 18', 'Game 19', 'Game 20'];
            }
            
            // Update the button styles to show the active period
            var buttons = document.getElementsByClassName("btn");
            for (var i = 0; i < buttons.length; i++) {
                if (buttons[i].id == "defaultOpen") {
                    buttons[i].classList.add("active");
                } else {
                    buttons[i].classList.remove("active");
                }
            }
            
            myChart.update();
        }
    </script>

    
      
</div>
    
</body>
</html>